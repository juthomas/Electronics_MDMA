#include "../../inc/mdma.h"
#define SWORD "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\1\1\1\15\15\15\20\21\20\0\0\0\0\0\0\0\0\0\0\0\0\1\1\1\15\15\15\20\21\20\10\11\12\0\1\0\0\1\0\0\0\0\1\1\1\15\15\15\20\21\20\10\11\12\0\0\1\13\21\0\13\21\0\1\2\1\15\15\15\20\21\20\10\11\12\0\0\1\0\0\0\1\2\0\13\21\1\15\15\15\20\21\20\10\11\12\0\0\1\0\0\0\0\0\0\0\1\0\5\14\3\13\21\1\10\11\12\1\1\1\0\0\0\0\0\0\0\0\0\5\13\3\5\13\3\3\11\5\13\21\0\13\21\0\0\1\0\0\0\0\0\0\0\2\10\5\2\10\5\0\0\0\1\2\0\13\21\0\0\1\0\0\0\0\0\0\0"

#define PURSE "\0\0\0\0\0\0\7\16\3\7\16\4\7\16\4\2\11\5\1\1\1\0\0\0\0\0\0\0\0\0\0\1\0\13\21\0\13\21\0\2\3\0\0\0\0\0\0\0\0\0\0\0\0\0\13\21\0\7\16\3\7\16\4\3\11\5\0\1\0\0\0\0\2\3\0\7\16\3\13\21\0\7\16\3\7\16\4\7\16\4\2\11\5\0\1\0\7\16\3\7\16\4\7\16\4\13\21\0\7\16\3\7\16\4\2\11\5\2\10\5\7\16\3\7\16\4\7\16\4\7\16\4\7\16\4\3\11\5\2\10\5\2\10\5\7\16\4\7\16\4\7\16\4\7\16\4\3\11\5\2\10\5\2\10\5\2\10\5\0\2\0\2\10\5\2\10\5\2\10\5\2\10\5\2\10\5\2\10\5\0\1\0"

#define BOW "\0\0\0\0\0\0\0\1\0\5\13\3\5\13\3\5\13\3\5\13\3\0\0\0\0\0\0\0\1\0\5\13\3\2\10\5\1\3\4\15\15\15\1\1\1\0\0\0\0\0\0\5\13\3\2\10\5\1\2\4\1\3\4\20\21\20\1\1\1\0\0\0\0\0\0\5\13\3\2\10\5\0\2\4\1\3\4\20\21\20\1\1\1\0\0\0\0\1\0\5\13\3\2\10\5\0\2\4\1\3\4\20\21\20\1\1\1\0\0\0\0\1\0\5\13\3\2\10\5\1\2\4\1\3\4\20\21\20\1\1\1\0\0\0\0\1\0\0\1\0\5\13\3\2\10\5\2\3\4\20\21\20\1\1\1\0\0\0\0\0\0\0\0\0\0\1\0\5\13\3\5\13\3\5\14\4\5\13\3\0\0\0"

#define POTION "\0\0\0\1\1\1\20\21\20\20\21\20\20\21\20\20\21\20\1\1\1\0\0\0\0\0\0\0\0\0\1\2\1\15\15\15\15\15\15\1\2\1\0\0\0\0\0\0\0\0\0\0\0\0\2\2\2\20\21\20\20\21\20\2\2\2\0\0\0\0\0\0\0\0\0\2\2\2\20\21\20\10\11\13\10\11\13\20\21\20\2\2\2\0\0\0\1\1\1\20\21\20\14\3\21\14\3\21\14\3\21\14\3\21\20\21\20\1\1\1\1\1\1\20\21\20\14\3\21\14\2\21\14\2\21\14\3\21\20\21\20\1\1\1\0\0\0\15\15\15\14\3\21\14\3\21\14\3\21\14\3\21\15\15\15\0\0\0\0\0\0\1\1\1\15\15\15\15\15\15\15\15\15\15\15\15\1\1\1\0\0\0"

#define COIN "\0\0\0\2\2\0\20\21\3\20\21\3\20\21\3\7\16\4\0\1\0\0\0\0\2\2\0\20\21\2\7\16\3\13\21\0\13\21\0\20\21\2\7\16\3\0\1\0\20\21\2\7\16\4\13\21\0\20\21\2\7\16\3\13\21\0\20\21\2\7\16\4\20\21\2\7\16\4\20\21\2\20\21\2\20\21\2\7\16\4\20\21\2\7\16\4\20\21\2\7\16\4\20\21\2\20\21\2\20\21\2\7\16\4\20\21\2\7\16\4\20\21\2\7\16\4\13\21\0\20\21\2\7\16\3\13\21\0\20\21\2\7\16\4\2\2\0\20\21\2\7\16\3\13\21\0\13\21\0\20\21\2\7\16\3\0\1\0\0\0\0\2\2\0\20\21\3\20\21\3\20\21\3\7\16\4\0\1\0\0\0\0"

#define GEM "\0\0\0\0\0\0\2\2\2\20\21\20\14\3\21\1\1\2\0\0\0\0\0\0\0\0\0\2\2\2\20\21\20\20\21\20\14\3\21\14\2\21\1\0\2\0\0\0\2\2\2\20\21\20\20\21\20\20\21\20\14\3\21\14\2\21\14\2\21\1\1\2\20\21\20\20\21\20\20\21\20\20\21\20\14\3\21\14\3\21\14\3\21\14\3\21\14\3\21\14\3\21\14\3\21\14\3\21\10\11\13\10\11\12\10\11\12\10\11\12\2\1\2\14\2\21\14\2\21\14\3\21\10\11\12\10\11\12\10\11\12\0\1\1\0\0\0\1\0\2\14\2\21\14\3\21\10\11\12\10\11\12\0\0\1\0\0\0\0\0\0\0\0\0\2\1\2\14\3\21\10\11\12\0\1\1\0\0\0\0\0\0"

uint8_t *feed_one_pixel(uint16_t pixel_index, uint8_t *pixels, uint32_t color)
{
		// ((((color & 0xFF0000) >> (int32_t)16) * percentage / 100) << (int32_t)16) +

	if (color & 0xFF000000)
	{
		pixels[pixel_index * 3] = ((color & 0x00FF00) >> 8) * ((color & 0xFF000000) >> 24) / 0xFF;
		pixels[pixel_index * 3 + 1] = ((color & 0xFF0000) >> 16) * ((color & 0xFF000000) >> 24) / 0xFF;
		pixels[pixel_index * 3 + 2] = (color & 0x0000FF) * ((color & 0xFF000000) >> 24) / 0xFF;
	}
	else
	{
		pixels[pixel_index * 3] = (color & 0x00FF00) >> 8;
		pixels[pixel_index * 3 + 1] = (color & 0xFF0000) >> 16;
		pixels[pixel_index * 3 + 2] = color & 0x0000FF;
	}
	
	return (pixels);
}

uint32_t	rainbow_wheel(uint8_t pos)
{
	uint8_t red;
	uint8_t green;
	uint8_t blue;

	if (pos < 85)
	{
		red = pos * 3;
		green = 255 - pos * 3;
		blue = 0;
		
	}
	else if (pos < 170)
	{
		pos -= 85;
		red = 255 - pos * 3;
		green = 0;
		blue = pos * 3;

	}
	else 
	{
		pos -= 170;
		red = 0;
		green = pos * 3;
		blue = 255 - pos * 3;
	}
	return (((int32_t)red << (int32_t)16) + ((int32_t)green << (int32_t)8) + (int32_t)blue);
}

uint32_t	reduce_luminosity(uint32_t color, uint8_t percentage)
{
	return (
			((((color & 0xFF0000) >> (int32_t)16) * percentage / 100) << (int32_t)16) +
			((((color & 0x00FF00) >> (int32_t)8) * percentage / 100) << (int32_t)8) +
			((((color & 0x0000FF) >> (int32_t)0) * percentage / 100) << (int32_t)0)
		);
}

void	led_draw_animation(uint16_t pixels_number)
{
	uint8_t pixels[pixels_number * 3];
	uint32_t colors = 0xFF0000;

	const uint8_t *sword = led_gimp_sword();
	const uint8_t *purse = led_gimp_purse();
	const uint8_t *bow = led_gimp_bow();
	const uint8_t *potion = led_gimp_potion();
	const uint8_t *coin = led_gimp_coin();
	const uint8_t *gem = led_gimp_gem();

	serial_putstr("hello\r\n");

	ft_pin_mode(51, FT_OUTPUT);
	ft_pin_mode(3, FT_OUTPUT);


	// uint8_t red = 0;
	for (;;)
	{


		led_send_data(3, SWORD, 64);
		for (int32_t i = 0; i < 1000000; i++);
		led_send_data(3, PURSE, 64);
		for (int32_t i = 0; i < 1000000; i++);
		led_send_data(3, BOW, 64);
		for (int32_t i = 0; i < 1000000; i++);
		led_send_data(3, POTION, 64);
		for (int32_t i = 0; i < 1000000; i++);
		led_send_data(3, COIN, 64);
		for (int32_t i = 0; i < 1000000; i++);
		led_send_data(3, GEM, 64);
		for (int32_t i = 0; i < 1000000; i++);
	}
}
